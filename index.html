<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Любимой Насте</title>
  <style>
    :root{
      --neon:#ff3aa7;
      --neonSoft:#ff7bc6;
      --bg1:#120014;
      --bg2:#2a0030;
    }
    html,body{height:100%; margin:0;}
    body{
      overflow:hidden;
      background: radial-gradient(circle at 50% 40%, var(--bg2), var(--bg1));
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      user-select:none;
    }
    canvas{display:block;}

    .glow-dots{
      position:fixed; inset:0;
      background:
        radial-gradient(circle at 20% 30%, rgba(255,58,167,.25) 0 2px, transparent 3px),
        radial-gradient(circle at 70% 25%, rgba(255,123,198,.18) 0 2px, transparent 3px),
        radial-gradient(circle at 40% 75%, rgba(255,58,167,.15) 0 2px, transparent 3px),
        radial-gradient(circle at 85% 70%, rgba(255,123,198,.12) 0 2px, transparent 3px);
      opacity:.85; pointer-events:none;
      filter: blur(.3px);
      z-index:2;
    }

    .name{
      position:fixed;
      left:50%; top:50%;
      transform:translate(-50%,-50%);
      z-index:5;
      padding: 12px 22px;
      border-radius:999px;
      font-size:42px;
      font-weight:950;

      background: linear-gradient(180deg, #ffffff, #ffd6f0);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;

      text-shadow:
        0 1px 0 rgba(255,154,217,.85),
        0 2px 0 rgba(255,123,198,.75),
        0 3px 0 rgba(255,58,167,.65),
        0 5px 16px rgba(255,58,167,.55),
        0 0 42px rgba(255,58,167,.45);

      border: 1px solid rgba(255,255,255,.10);
      background-color: rgba(0,0,0,.14);
      -webkit-text-fill-color: transparent;
      backdrop-filter: blur(7px);
      pointer-events:none;
    }

    .banner{
      position:fixed;
      left:50%;
      top:16px;
      transform:translateX(-50%) translateY(-12px);
      z-index:6;
      padding: 12px 18px;
      border-radius:999px;
      font-weight:950;
      font-size:20px;
      color:#fff;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.14);
      backdrop-filter: blur(8px);
      text-shadow:
        0 0 10px rgba(255,255,255,.55),
        0 0 26px rgba(255,58,167,.55),
        0 0 52px rgba(255,58,167,.35);
      opacity:0;
      pointer-events:none;
      transition: opacity .8s ease, transform .8s ease;
      filter: drop-shadow(0 0 18px rgba(255,58,167,.25));
    }
    .banner.show{
      opacity:1;
      transform:translateX(-50%) translateY(0);
    }

    .hint{
      position:fixed;
      left:50%;
      bottom:22px;
      transform:translateX(-50%);
      z-index:6;
      padding:10px 14px;
      border-radius:999px;
      font-size:14px;
      color: rgba(255,255,255,.82);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(6px);
      text-shadow: 0 0 12px rgba(255,58,167,.35);
    }

    .float-heart{
      position:fixed;
      bottom:-40px;
      width: 18px;
      height: 18px;
      transform: rotate(-45deg);
      opacity: .45;
      filter: drop-shadow(0 0 10px rgba(255,58,167,.35));
      pointer-events:none;
      z-index:4;
      animation: rise linear forwards;
    }
    .float-heart::before,
    .float-heart::after{
      content:"";
      position:absolute;
      width: 100%; height: 100%;
      background: radial-gradient(circle at 30% 30%, rgba(255,209,234,.9), rgba(255,123,198,.78));
      border-radius: 50%;
    }
    .float-heart::before{ top:-50%; left:0; }
    .float-heart::after{ top:0; left:50%; }
    .float-heart .core{
      position:absolute; inset:0;
      background: radial-gradient(circle at 30% 30%, rgba(255,209,234,.9), rgba(255,58,167,.78));
      border-radius: 4px;
    }

    .gift-bouquet{
      position:fixed;
      left:18%;
      top:50%;
      z-index:6;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
      opacity:0;
      pointer-events:none;
      transform: translate(-120%, -50%) rotate(-10deg);
      transition: transform .7s ease, opacity .7s ease;
      filter: drop-shadow(0 0 14px rgba(255,123,198,.38));
    }
    .gift-bouquet.show{
      opacity:1;
      transform: translate(0, -50%) rotate(-3deg);
    }
    .gift-bouquet .icon{
      font-size:92px;
      line-height:1;
    }
    .gift-bouquet .text{
      font-size:28px;
      font-weight:900;
      color:#fff;
      text-shadow:
        0 0 10px rgba(255,255,255,.5),
        0 0 20px rgba(255,58,167,.5);
      white-space:nowrap;
    }

    @keyframes rise{
      0%   { transform: translateX(var(--sx)) translateY(0) rotate(var(--rot)); opacity: 0; }
      10%  { opacity: var(--op); }
      100% { transform: translateX(var(--sx2)) translateY(-115vh) rotate(calc(var(--rot) + 240deg)); opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="glow-dots"></div>
  <div class="banner" id="banner">С днём святого Валентина, Любимая!❤️</div>
  <div class="name">Это тебе)</div>
  <div class="hint">Нажми на сердечкооо</div>
  <div class="gift-bouquet" id="giftBouquet">
    <div class="icon">💐</div>
    <div class="text">И это тоже тебе)</div>
  </div>

  <script type="module">
    import * as THREE from "https://unpkg.com/three@0.160.0/build/three.module.js";

    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
    renderer.setSize(innerWidth, innerHeight);
    document.body.appendChild(renderer.domElement);

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 100);
    camera.position.set(0, 0.15, 4.3);

    scene.add(new THREE.AmbientLight(0xffffff, 0.45));

    const pink = new THREE.PointLight(0xff3aa7, 2.6, 30);
    pink.position.set(2.4, 2.0, 3.6);
    scene.add(pink);

    const rim = new THREE.PointLight(0xff7bc6, 1.8, 30);
    rim.position.set(-2.6, 0.9, 2.8);
    scene.add(rim);

    function makeHeartShapeFormula(pointsCount = 320) {
      const pts = [];
      for (let i = 0; i <= pointsCount; i++) {
        const t = (i / pointsCount) * Math.PI * 2;
        const x = 16 * Math.pow(Math.sin(t), 3);
        const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);

        pts.push(new THREE.Vector2(x, y));
      }

      const scale = 0.085;
      for (const p of pts) { p.multiplyScalar(scale); }

      const shape = new THREE.Shape(pts);
      return shape;
    }

    const heartShape = makeHeartShapeFormula();

    const geometry = new THREE.ExtrudeGeometry(heartShape, {
      depth: 0.7,
      bevelEnabled: true,
      bevelThickness: 0.18,
      bevelSize: 0.16,
      bevelSegments: 8,
      curveSegments: 96,
      steps: 1
    });

    geometry.center();
    geometry.scale(0.92, 0.92, 0.92);

    const material = new THREE.MeshStandardMaterial({
      color: 0xff3aa7,
      emissive: 0xff2a9a,
      emissiveIntensity: 0.6,
      roughness: 0.18,
      metalness: 0.38
    });

    const heart = new THREE.Mesh(geometry, material);
    heart.rotation.x = 0.18;
    heart.rotation.y = Math.PI;
    scene.add(heart);

    const glowMat = new THREE.MeshStandardMaterial({
      color: 0xff7bc6,
      emissive: 0xff7bc6,
      emissiveIntensity: 1.0,
      transparent: true,
      opacity: 0.14,
      roughness: 0.9,
      metalness: 0.0
    });
    const glow = new THREE.Mesh(geometry.clone(), glowMat);
    glow.scale.setScalar(1.06);
    glow.rotation.copy(heart.rotation);
    scene.add(glow);

    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();
    const banner = document.getElementById("banner");
    const giftBouquet = document.getElementById("giftBouquet");

    let heartsInterval = null;

    function triggerGiftBouquet() {
      giftBouquet.classList.remove("show");
      void giftBouquet.offsetWidth;
      giftBouquet.classList.add("show");
    }

    function spawnFloatingHeart() {
      const h = document.createElement("div");
      h.className = "float-heart";
      h.innerHTML = `<div class="core"></div>`;

      const size = 10 + Math.random() * 22;
      h.style.width = `${size}px`;
      h.style.height = `${size}px`;

      const x = Math.random() * window.innerWidth;
      const sx = (Math.random() - 0.5) * 40;
      const sx2 = (Math.random() - 0.5) * 220;

      const rot = (Math.random() - 0.5) * 120;
      const op = 0.22 + Math.random() * 0.42;
      const dur = 4.5 + Math.random() * 4.8;

      h.style.left = `${x}px`;
      h.style.setProperty("--sx", `${sx}px`);
      h.style.setProperty("--sx2", `${sx2}px`);
      h.style.setProperty("--rot", `${rot}deg`);
      h.style.setProperty("--op", `${op}`);
      h.style.animationDuration = `${dur}s`;

      document.body.appendChild(h);
      setTimeout(() => h.remove(), (dur + 0.6) * 1000);
    }

    function startHeartsUp() {
      if (heartsInterval) return;
      heartsInterval = setInterval(() => {
        spawnFloatingHeart();
        if (Math.random() > 0.45) spawnFloatingHeart();
      }, 220);
    }

    function onPointerDown(e){
      const rect = renderer.domElement.getBoundingClientRect();
      mouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
      mouse.y = -(((e.clientY - rect.top) / rect.height) * 2 - 1);

      raycaster.setFromCamera(mouse, camera);
      const hits = raycaster.intersectObject(heart, false);

      if (hits.length) {
        banner.classList.add("show");
        startHeartsUp();
        triggerGiftBouquet();
      }
    }
    window.addEventListener("pointerdown", onPointerDown);

    let t0 = performance.now();
    function animate(){
      const t = performance.now();
      const dt = (t - t0) * 0.001;
      t0 = t;

      heart.rotation.y += dt * 0.9;
      glow.rotation.y = heart.rotation.y;

      const pulse = 1.0 + Math.sin(t * 0.0048) * 0.06;
      heart.scale.setScalar(pulse);
      glow.scale.setScalar(pulse * 1.06);

      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }
    animate();

    addEventListener("resize", () => {
      camera.aspect = innerWidth/innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth, innerHeight);
    });
  </script>
</body>
</html>
